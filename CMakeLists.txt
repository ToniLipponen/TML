cmake_minimum_required(VERSION 3.10)
project(TML)
option(TML_DEBUG_OPENGL_CALLS "Applies error checking around opengl function calls." yes)

if(NOT TML_DEBUG_OPENGL_CALLS)
    add_compile_definitions(TML_NO_GL_DEBUGGING=1)
endif()

file(GLOB_RECURSE SRC_FILES src/*.cpp src/glad.c)
add_subdirectory(external/glfw/)
include_directories(external/glm)

# I'm sick of dealing with linking dlls on windows.
if(WIN32 OR MSVC)
    set(GLFW_LIBARY_TYPE OBJECT)
    add_library(TML STATIC ${SRC_FILES})
    target_compile_features(TML PUBLIC cxx_std_17)
    target_link_libraries(TML glfw)
elseif(UNIX)
    set(GLFW_LIBARY_TYPE STATIC)
    add_library(TML SHARED ${SRC_FILES})
    target_compile_features(TML PUBLIC cxx_std_17)
    target_link_libraries(TML glfw dl pthread)
endif()
target_include_directories(TML PUBLIC external/glm external/glfw/include include external)